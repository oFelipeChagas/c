{% extends "base.html" %}

{% block title %}Home - Conversatórium{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8 text-center">
            <h1 class="mt-5 mb-4">Bem-vindo ao Conversatórium</h1>
            <p class="lead mb-5">
                A necessidade de conversar e desabafar é uma parte fundamental da experiência humana. 
                Compartilhar nossos pensamentos, sentimentos e experiências não apenas alivia o estresse, 
                mas também nos ajuda a processar emoções, ganhar novas perspectivas e encontrar soluções 
                para os desafios da vida. No Conversatórium, oferecemos um espaço seguro e acolhedor 
                para você expressar-se livremente e receber o apoio de que precisa.
            </p>
            <h2 class="mb-4">Como podemos ajudar você hoje?</h2>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <a href="/ser-escutado" class="btn btn-primary btn-lg btn-block">
                        Quero ser escutado
                    </a>
                    <p class="mt-2">Um ouvinte atento e compreensivo para seus pensamentos e sentimentos.</p>
                </div>
                <div class="col-md-6 mb-3">
                    <a href="/quero-solucoes" class="btn btn-success btn-lg btn-block">
                        Quero soluções
                    </a>
                    <p class="mt-2">Orientação pragmática e ideias para resolver seus desafios.</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const chatForm = document.getElementById('chatForm');
    const messageInput = document.getElementById('messageInput');
    const chatMessages = document.getElementById('chatMessages');

    chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const message = messageInput.value.trim();
        if (message) {
            addMessage('Você', message);
            messageInput.value = '';
            
            // Enviar mensagem para o servidor
            fetch('/chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({message: message}),
            })
            .then(response => response.json())
            .then(data => {
                addMessage('IA', data.response);
            })
            .catch((error) => {
                console.error('Error:', error);
                addMessage('Sistema', 'Ocorreu um erro ao processar sua mensagem.');
            });
        }
    });

    function addMessage(sender, text) {
        const messageElement = document.createElement('div');
        messageElement.className = 'message';
        messageElement.innerHTML = `<strong>${sender}:</strong> ${text.replace(/\n/g, '<br>')}`;
        chatMessages.appendChild(messageElement);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Exemplo de mensagens iniciais
    addMessage('Sistema', 'Bem-vindo ao chat do Conversatórium!');
    addMessage('Sistema', 'Comece a conversar digitando sua mensagem abaixo.');
});
</script>
{% endblock %}
